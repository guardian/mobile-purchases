AWSTemplateFormatVersion: 2010-09-09
Description: 'Mobile Purchases DynamoDB'

Parameters:
  ReadCapacityUnits:
    Description: DynamoDb Read Capacity Units
    Type: Number
  WriteCapacityUnits:
    Description: DynamoDb Write Capacity Units
    Type: Number
  Stack:
    Description: Stack name
    Type: String
  App:
    Description: Application name
    Type: String
  Stage:
    Description: Stage name
    Type: String
    AllowedValues:
      - CODE
      - PROD
Resources:
  userPurchasesTable:
    Type: AWS::DynamoDB::Table
    Properties:
      TableName: !Sub ${App}-${Stage}-${Stack}-user-purchases
      AttributeDefinitions:
        - AttributeName: userIdColonAppId
          AttributeType: S
      KeySchema:
        - AttributeName: userIdColonAppId
          KeyType: HASH
      ProvisionedThroughput:
        ReadCapacityUnits: !Ref ReadCapacityUnits
        WriteCapacityUnits: !Ref WriteCapacityUnits
      SSESpecification:
        SSEEnabled: true
      TimeToLiveSpecification:
        Enabled: true
        AttributeName: 'ttl'

